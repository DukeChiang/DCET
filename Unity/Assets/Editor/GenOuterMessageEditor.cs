using DCETRuntime;
using System.Collections;
using System.Collections.Generic;
using System.IO;
using UnityEditor;

namespace DCETEditor
{
    public class GenOuterMessageEditor:Editor
    {
        public static string unity3dEx = ".unity3d";

        [MenuItem("Tools/AssetBundle/ASYNC生成outermessage.txt")]
        /// <summary>
        /// 设置协议AB名
        /// </summary>
        public static void SetProtoABName()
        {
            string protoPath = Path.GetFullPath("../Proto/OuterMessage.proto");
            string localPath = "Assets/Res/Lua/pbc/AutoGeneratedCode/OuterMessage.txt";
            string targetPath = Path.GetFullPath(localPath);
            string filename = Path.GetFileNameWithoutExtension(targetPath);
            FileHelper.CopyFile(protoPath, targetPath, true);
            AssetDatabase.Refresh();
            AssetImporter assetImporter = AssetImporter.GetAtPath(localPath);
            Log.Debug($"ab name:{filename.ToLower()}{unity3dEx}");
            assetImporter.assetBundleName = $"{filename.ToLower()}{unity3dEx}";
            AssetDatabase.Refresh();
        }
    }
}